<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Windows Basic Web Edition - Desktop</title>
<style>
:root{
  --ui-dark:#0b0b0b;
  --title-blue:#0078d7;
  --cmd-green:#00ff00;
  --muted:#9ca3af;
}
html,body{height:100%;margin:0;overflow:hidden;font-family:Consolas,monospace;color:var(--cmd-green);}
#desktop{position:relative;width:100%;height:100%;background:linear-gradient(#0b0b0b,#111);}
.window{width:600px;height:400px;border:2px solid #333;box-shadow:0 20px 40px rgba(0,0,0,.8);display:flex;flex-direction:column;background:var(--ui-dark);position:absolute;top:50px;left:50px;}
.title-bar{background:var(--title-blue);color:#fff;padding:6px 10px;display:flex;justify-content:space-between;align-items:center;user-select:none;cursor:move;}
.controls{display:flex;gap:8px;}
.control{width:18px;height:18px;background:#fff;color:#000;font-size:12px;border-radius:2px;display:flex;align-items:center;justify-content:center;cursor:pointer;}
#taskbar{position:absolute;bottom:0;left:0;right:0;height:40px;background:#222;display:flex;align-items:center;padding:0 8px;box-shadow:0 -4px 10px rgba(0,0,0,.5);}
#startBtn{width:80px;height:30px;background:var(--title-blue);color:#fff;border:none;border-radius:4px;cursor:pointer;font-family:"Segoe UI",sans-serif;}
#startMenu{position:absolute;bottom:40px;left:0;width:200px;background:#111;border:1px solid #333;display:none;flex-direction:column;padding:8px;box-shadow:0 4px 20px rgba(0,0,0,.8);}
#startMenu button{background:transparent;border:none;color:var(--cmd-green);padding:6px 8px;text-align:left;cursor:pointer;border-radius:4px;}
</style>
</head>
<body>

<div id="desktop"></div>

<div id="taskbar">
  <button id="startBtn">Start</button>
</div>
<div id="startMenu"></div> <!-- empty start menu -->

<script>
// Vault verification
(function(){
  const SESSION_KEY='vaultAccess';
  const data=sessionStorage.getItem(SESSION_KEY);

  if(!data){ window.location.href='index.html'; return; }
  try {
    const {expiry}=JSON.parse(data);
    if(Date.now() > expiry){ 
      sessionStorage.removeItem(SESSION_KEY); 
      window.location.href='index.html'; 
      return; 
    }
  } catch {
    window.location.href='index.html'; 
    return; 
  }

  // Remove token so it can't be reused
  sessionStorage.removeItem(SESSION_KEY);
})();

// Desktop & windows logic
const desktop=document.getElementById('desktop');
const startBtn=document.getElementById('startBtn');
const startMenu=document.getElementById('startMenu');

startBtn.addEventListener('click',()=>{startMenu.style.display=startMenu.style.display==='flex'?'none':'flex';});

function createWindow(title){
  const win=document.createElement('div'); win.className='window';
  const titlebar=document.createElement('div'); titlebar.className='title-bar';
  titlebar.textContent=title;
  const controls=document.createElement('div'); controls.className='controls';
  const min=document.createElement('div'); min.className='control'; min.textContent='−';
  const max=document.createElement('div'); max.className='control'; max.textContent='□';
  const close=document.createElement('div'); close.className='control'; close.textContent='×';
  controls.appendChild(min); controls.appendChild(max); controls.appendChild(close);
  titlebar.appendChild(controls);
  win.appendChild(titlebar);
  const content=document.createElement('div'); content.style.flex='1'; content.style.background='var(--ui-dark)';
  content.style.color='var(--cmd-green)'; content.style.display='flex'; content.style.alignItems='center'; content.style.justifyContent='center';
  content.textContent=`${title} is ready...`;
  win.appendChild(content);
  desktop.appendChild(win);

  // Dragging
  let offsetX=0,offsetY=0,isDragging=false;
  titlebar.addEventListener('mousedown',e=>{isDragging=true; offsetX=e.offsetX; offsetY=e.offsetY; win.style.zIndex=1000;});
  document.addEventListener('mousemove',e=>{if(isDragging){win.style.left=(e.pageX-offsetX)+'px'; win.style.top=(e.pageY-offsetY)+'px';}});
  document.addEventListener('mouseup',()=>{isDragging=false;});

  close.addEventListener('click',()=>{desktop.removeChild(win);});
  min.addEventListener('click',()=>{win.style.display='none';});
  max.addEventListener('click',()=>{win.style.width='90%'; win.style.height='80%'; win.style.left='5%'; win.style.top='5%';});
}
</script>
</body>
</html>
