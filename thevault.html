<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Windows Web Edition</title>
<style>
  :root{
    --title-blue:#0078D7;
    --bg:#0b0b0b;
    --muted:#9ca3af;
    --window-bg:#fff;
  }
  html,body{height:100%;margin:0;font-family:"Segoe UI",Tahoma,Arial,sans-serif;background:linear-gradient(#0b0b0b,#111);color:#e6e6e6;overflow:hidden;}
  #desktop{position:relative;width:100%;height:100%;}

  /* Taskbar */
  #taskbar{position:absolute;left:0;right:0;bottom:0;height:42px;background:#111;border-top:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;gap:8px;padding:0 8px;box-shadow:0 -6px 20px rgba(0,0,0,0.6);z-index:1200;}
  #startBtn{height:34px;width:42px;background:transparent;border:none;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;}
  #startBtn:hover{background:rgba(255,255,255,0.03);}
  .win-logo{width:20px;height:20px;fill:#fff;filter:drop-shadow(0 1px 0 rgba(0,0,0,0.5));}
  #taskbarApps{display:flex;gap:6px;align-items:center;margin-left:8px;}
  .start-item{background:transparent;color:var(--muted);border:none;padding:6px 10px;text-align:center;border-radius:4px;cursor:pointer;font-size:13px;}
  .start-item:hover{background:rgba(255,255,255,0.02);color:#fff;}

  /* Context menu */
  #ctxMenu{position:absolute;display:none;background:#202020;border:1px solid rgba(255,255,255,0.06);color:#fff;padding:6px;border-radius:6px;z-index:1600;min-width:170px;box-shadow:0 8px 20px rgba(0,0,0,0.6)}
  #ctxMenu button{display:block;width:100%;text-align:left;background:transparent;border:none;padding:8px 10px;color:#ddd;cursor:pointer;border-radius:4px}
  #ctxMenu button:hover{background:rgba(255,255,255,0.03);color:#fff}

  /* Desktop icons */
  .icon{width:100px;text-align:center;color:var(--muted);position:absolute;cursor:pointer;user-select:none;}
  .icon img{width:64px;height:64px;display:block;margin:0 auto;border-radius:6px;}
  .icon span{display:block;margin-top:6px;font-size:12px;color:var(--muted);}

  /* Windows */
  .window{position:absolute;width:800px;height:560px;background:var(--window-bg);color:#111;border-radius:6px;box-shadow:0 12px 40px rgba(0,0,0,0.7);overflow:hidden;display:none;flex-direction:column;z-index:1000;}
  .titlebar{height:36px;background:linear-gradient(180deg,var(--title-blue),#0062b0);color:#fff;display:flex;align-items:center;justify-content:space-between;padding:0 10px;cursor:move;user-select:none;}
  .title{font-weight:600;font-size:13px;display:flex;gap:10px;align-items:center}
  .controls{display:flex;gap:6px;align-items:center}
  .tb-btn{width:34px;height:26px;border-radius:4px;border:none;background:transparent;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
  .tb-btn:hover{background:rgba(255,255,255,0.06)}
  .window-body{flex:1;background:var(--window-bg);display:flex;align-items:center;justify-content:center;padding:16px;overflow:auto}

  /* Popups & factory fullscreen */
  .factory-full{position:fixed;left:0;top:0;width:100%;height:100%;background:#fff;z-index:2000;display:flex;flex-direction:column;align-items:center;justify-content:center}
  .progress-wrap{width:70%;max-width:900px;height:18px;background:#eee;border-radius:9px;overflow:hidden;border:1px solid #ddd}
  .progress-inner{height:100%;width:0%;background:linear-gradient(90deg,var(--title-blue),#005a9e)}
</style>
</head>
<body>
<div id="desktop">

  <!-- Taskbar -->
  <div id="taskbar">
    <button id="startBtn"><svg class="win-logo" viewBox="0 0 24 24"><path d="M3 3.5v8.5l8 0.5V3.5H3zM13 3.3v8.7l8-1V3.3h-8zM3 13.5v7l8-1V12.5H3zM13 13.2v7.3l8-0.9v-6.4l-8 0z"/></svg></button>
    <div id="taskbarApps"></div>
  </div>

  <!-- Context menu -->
  <div id="ctxMenu">
    <button id="ctxOpen">Open</button>
    <button id="ctxProperties">Properties</button>
    <button id="ctxDelete">Delete</button>
  </div>

  <!-- Desktop icons -->
  <div class="icon" id="iconMinecraft" data-app="minecraft" style="left:20px;top:20px;">
    <img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/c/c7/Grass_Block.png" alt="Minecraft"/>
    <span>Minecraft</span>
  </div>
  <div class="icon" id="iconRequest" data-app="request" style="left:140px;top:20px;">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/65/Apps-icon.png" alt="Request App"/>
    <span>Request App</span>
  </div>
  <div class="icon" id="iconFortnite" data-app="fortnite" style="left:260px;top:20px;">
    <img src="https://upload.wikimedia.org/wikipedia/en/thumb/e/eb/Fortnite_logo.svg/1200px-Fortnite_logo.svg.png" alt="Fortnite"/>
    <span>Fortnite</span>
  </div>
  <div class="icon" id="iconFactory" data-app="factory" style="left:380px;top:20px;">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Red_Delete_icon.svg/1024px-Red_Delete_icon.svg.png" alt="Factory Reset"/>
    <span>Factory Reset</span>
  </div>

  <!-- Minecraft window -->
  <div class="window" id="mcWindow">
    <div class="titlebar"><div class="title">Minecraft</div>
      <div class="controls"><button class="tb-btn" data-action="close">✕</button></div>
    </div>
    <div class="window-body">
      <p>This app has recently been blocked, please wait while I try to find another unblocked copy.</p>
    </div>
  </div>

  <!-- Request window -->
  <div class="window" id="reqWindow">
    <div class="titlebar"><div class="title">Request an App</div>
      <div class="controls"><button class="tb-btn" data-action="close">✕</button></div>
    </div>
    <iframe src="suggest.html" style="width:100%;height:100%;border:0;"></iframe>
  </div>

  <!-- Fortnite window -->
  <div class="window" id="fnWindow">
    <div class="titlebar"><div class="title">Fortnite Launcher</div>
      <div class="controls"><button class="tb-btn" data-action="close">✕</button></div>
    </div>
    <div class="window-body" style="flex-direction:column;gap:12px;align-items:center;">
      <p>You need to be signed in to Amazon Prime and link Epic Games.</p>
      <button id="fnContinue" class="tb-btn" style="background:var(--title-blue);color:#fff;">Continue Anyway</button>
    </div>
  </div>

  <!-- Properties window -->
  <div class="window" id="propertiesWindow">
    <div class="titlebar"><div class="title">Properties</div>
      <div class="controls"><button class="tb-btn" data-action="close">✕</button></div>
    </div>
    <div class="window-body" id="propertiesBody" style="text-align:center;"></div>
  </div>

  <!-- Factory fullscreen -->
  <div class="factory-full" id="factoryFull" style="display:none;">
    <h1>Windows has been factory reset</h1>
    <p>Returning in <span id="factoryCountdown">10</span> seconds...</p>
    <div class="progress-wrap"><div id="factoryProgress" class="progress-inner"></div></div>
  </div>

</div>

<script>
const icons=document.querySelectorAll('.icon');
const windows={
  minecraft:document.getElementById('mcWindow'),
  request:document.getElementById('reqWindow'),
  fortnite:document.getElementById('fnWindow'),
  properties:document.getElementById('propertiesWindow')
};
const taskbarApps=document.getElementById('taskbarApps');
const ctxMenu=document.getElementById('ctxMenu');
let ctxTarget=null;

// Open windows
icons.forEach(ic=>{
  ic.addEventListener('dblclick',()=>{
    const app=ic.dataset.app;
    if(app==='minecraft') openWindow(windows.minecraft);
    else if(app==='request') openWindow(windows.request);
    else if(app==='fortnite') openWindow(windows.fortnite);
    else if(app==='factory') openFactory();
  });
  ic.addEventListener('contextmenu',(e)=>{
    e.preventDefault();
    ctxTarget=ic;
    ctxMenu.style.display='block';
    ctxMenu.style.left=e.pageX+'px';
    ctxMenu.style.top=e.pageY+'px';
  });
});

// Context menu actions
document.getElementById('ctxOpen').addEventListener('click',()=>{
  if(!ctxTarget) return;
  ctxTarget.dispatchEvent(new Event('dblclick'));
  ctxMenu.style.display='none';
});
document.getElementById('ctxProperties').addEventListener('click',()=>{
  if(!ctxTarget) return;
  let app=ctxTarget.dataset.app;
  let text='';
  switch(app){
    case 'minecraft': text='Minecraft in your web browser!'; break;
    case 'request': text='Suggest an app!'; break;
    case 'fortnite': text='Fortnite, in your web browser!'; break;
    case 'factory': text='Factory Reset (non-deletable)'; break;
  }
  document.getElementById('propertiesBody').textContent=text;
  openWindow(windows.properties);
  ctxMenu.style.display='none';
});
document.getElementById('ctxDelete').addEventListener('click',()=>{
  if(!ctxTarget) return;
  if(ctxTarget.dataset.app!=='factory') ctxTarget.style.display='none';
  ctxMenu.style.display='none';
});

// Fortnite continue button
document.getElementById('fnContinue').addEventListener('click',()=>{
  window.open('https://luna.amazon.co.uk/game/fortnite?lang=en-US&ref=tmp_ext_epic&autoplay=1','_blank');
});

// Open window helper
function openWindow(win){
  win.style.display='flex';
  addTaskbarButton(win);
  bringToFront(win);
}

// Taskbar buttons
function addTaskbarButton(win){
  if(document.querySelector('[data-win="'+win.id+'"]')) return;
  let btn=document.createElement('button');
  btn.className='start-item';
  btn.dataset.win=win.id;
  btn.textContent=win.querySelector('.title').textContent;
  btn.onclick=()=>{win.style.display=(win.style.display==='none')?'flex':'none';bringToFront(win);}
  btn.dataset.win=win.id;
  taskbarApps.appendChild(btn);
}

// Close buttons
document.querySelectorAll('.tb-btn[data-action="close"]').forEach(btn=>{
  btn.addEventListener('click',()=>btn.closest('.window').style.display='none');
});

// Bring to front
let zIndex=1000;
function bringToFront(el){ zIndex++; el.style.zIndex=zIndex; }

// Factory reset
const factoryFull=document.getElementById('factoryFull');
const factoryCountdown=document.getElementById('factoryCountdown');
const factoryProgress=document.getElementById('factoryProgress');
function openFactory(){
  factoryFull.style.display='flex';
  let sec=10;
  factoryCountdown.textContent=sec;
  factoryProgress.style.width='0%';
  const start=Date.now();
  const interval=setInterval(()=>{
    let passed=Math.floor((Date.now()-start)/1000);
    let remain=Math.max(0,sec-passed);
    factoryCountdown.textContent=remain;
    factoryProgress.style.width=((sec-remain)/sec*100)+'%';
    if(remain<=0){clearInterval(interval); location.reload();}
  },200);
}

// Auto-arrange icons
icons.forEach((ic,i)=>{
  let col=Math.floor(i/4),row=i%4;
  ic.style.left=(20+120*row)+'px';
  ic.style.top=(20+120*col)+'px';
});

// Hide context menu on click outside
document.addEventListener('click',e=>{
  if(!ctxMenu.contains(e.target)) ctxMenu.style.display='none';
});
</script>
</body>
</html>
